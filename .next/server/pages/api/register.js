"use strict";(()=>{var e={};e.id=553,e.ids=[553],e.modules={145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,r)=>{Object.defineProperty(r,"l",{enumerable:!0,get:function(){return function e(r,o){return o in r?r[o]:"then"in r&&"function"==typeof r.then?r.then(r=>e(r,o)):"function"==typeof r&&"default"===o?r:void 0}}})},6876:(e,r,o)=>{o.r(r),o.d(r,{config:()=>f,default:()=>c,routeModule:()=>p});var t={};o.r(t),o.d(t,{default:()=>d});var a=o(1802),i=o(7153),s=o(6249);let n=require("bcrypt");var u=o.n(n);let l=(0,require("mysql2/promise").createPool)({host:"localhost",user:"root",password:"",database:"db_archivoHistorico"});async function d(e,r){if("POST"===e.method){console.log("Datos recibidos:",e.body);let{primerNombre:o,segundoNombre:t,apellidoPaterno:a,apellidoMaterno:i,correo:s,telefono:n,password:d,rol:c,justificacion:f}=e.body;try{let[e]=await l.query("SELECT * FROM usuarios WHERE correo = ?",[s]);if(e.length>0)return r.status(400).json({message:"El usuario ya est\xe1 registrado"});let p=await u().hash(d,10),P=`
        INSERT INTO usuarios 
        (primer_nombre, segundo_nombre, apellido_paterno, apellido_materno, correo, telefono, password, fecha_creacion, fecha_modificacion, rol, justificacion)
        VALUES (?, ?, ?, ?, ?, ?, ?, NOW(), NOW(), ?, ?)
      `;await l.query(P,[o,t,a,i,s,n,p,c,f]),r.status(201).json({message:"Usuario registrado con \xe9xito"})}catch(e){console.error("Error al registrar el usuario:",e),r.status(500).json({message:"Error en el servidor",error:e})}}else r.status(405).json({message:"M\xe9todo no permitido"})}let c=(0,s.l)(t,"default"),f=(0,s.l)(t,"config"),p=new a.PagesAPIRouteModule({definition:{kind:i.x.PAGES_API,page:"/api/register",pathname:"/api/register",bundlePath:"",filename:""},userland:t})},7153:(e,r)=>{var o;Object.defineProperty(r,"x",{enumerable:!0,get:function(){return o}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(o||(o={}))},1802:(e,r,o)=>{e.exports=o(145)}};var r=require("../../webpack-api-runtime.js");r.C(e);var o=r(r.s=6876);module.exports=o})();